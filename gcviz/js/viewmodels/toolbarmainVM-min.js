(function(){define(["knockout","gcviz-i18n","gcviz-ko"],function(b,c,d){var a;a=function(g,f){var e=function(j,o){var p=this,q=locationPath+"gcviz/images/mainFullscreen.png",k=locationPath+"gcviz/images/mainShowInset.png",l=locationPath+"gcviz/images/mainSmallscreen.png",i=locationPath+"gcviz/images/mainTools.png",r=locationPath+"gcviz/images/mainHelp.png",m=$("#section"+o),h=$("#"+o),n=$("#"+o+"_0");p.counter=b.observable(0);p.imgFullscreen=b.observable(q);p.imgShowInset=k;p.imgTools=i;p.imgHelp=r;p.enableViewInset=b.observable(true);p.tpHelp=c.getDict("%toolbarmain-tphelp");p.tpTools=c.getDict("%toolbarmain-tptools");p.tpInset=c.getDict("%toolbarmain-tpinset");p.tpFullScreen=c.getDict("%toolbarmain-tpfullscreen");p.init=function(){p.heightSection=m.css("height");p.widthSection=m.css("width");p.heightMap=n.css("height");p.widthMap=n.css("width");p.insetState="";m[0].addEventListener("fullscreenchange",function(){if(!document.fullscreen){p.cancelFullScreen(document,o);p.imgFullscreen(q)}},false);m[0].addEventListener("mozfullscreenchange",function(){if(!document.mozFullScreen){p.cancelFullScreen(document,o);p.imgFullscreen(q)}},false);m[0].addEventListener("webkitfullscreenchange",function(){if(!document.webkitIsFullScreen){p.cancelFullScreen(document,o);p.imgFullscreen(q)}},false);return{controlsDescendantBindings:true}};p.fullscreenClick=function(){var s=(document.fullScreenElement&&document.fullScreenElement!==null)||(document.mozFullScreen||document.webkitIsFullScreen);if(s){p.cancelFullScreen(document,o);p.imgFullscreen(q)}else{p.requestFullScreen(m[0],o);p.imgFullscreen(l)}};p.insetClick=function(t){var s=h.find(".gcviz-inset"+o);if(t==="hidden"){s.addClass("hidden")}else{if(s.hasClass("hidden")){s.removeClass("hidden")}else{s.addClass("hidden")}}};p.toolsClick=function(){var s=h.find(".gcviz-tbholder");if(s.hasClass("hidden")){s.removeClass("hidden");m.find(".dijitTitlePaneTitleFocus")[0].focus()}else{s.addClass("hidden")}};p.helpClick=function(){p.counter(p.counter()+1);alert(c.getDict("%toolbarmain-help")+": "+p.counter())};p.cancelFullScreen=function(t,s){var u=t.cancelFullScreen||t.webkitCancelFullScreen||t.mozCancelFullScreen||t.exitFullscreen;if(u){u.call(t)}m.css({width:p.widthSection,height:p.heightSection});h.css({width:p.widthSection,height:p.heightSection});n.css({width:p.widthMap,height:p.heightMap});p.insetClick(p.insetState);p.enableViewInset(true)};p.requestFullScreen=function(t,s){var u=t.requestFullScreen||t.webkitRequestFullScreen||t.mozRequestFullScreen||t.msRequestFullScreen;if(u){u.call(t)}t.setAttribute("style","width: 100%; height: 100%;");t.getElementsByClassName("gcviz")[0].setAttribute("style","width: 100%; height: 93%;");t.getElementsByClassName("gcviz-map")[0].setAttribute("style","width: 100%; height: 100%;");if(h.find(".gcviz-inset"+s).hasClass("hidden")){p.insetState="hidden"}else{p.insetState=""}p.insetClick("hidden");p.enableViewInset(false)};p.init()};b.applyBindings(new e(g,f),g[0])};return{initialize:a}})}).call(this);